{"version":3,"sources":["gameControl/actionTypes.js","constants.js","utils/index.js","gameControl/reducer.js","chessBoard/actionTypes.js","chessBoard/actions.js","utils/controlClients/SocketClient.js","player/actions.js","player/actionTypes.js","utils/boardUtils.js","chessBoard/views/chessItem.js","utils/ai/ai.js","utils/controlClients/AIClient.js","gameControl/views/gamePlaying.js","menu/menuPage.js","menu/RoomMenu.js","gameControl/views/routeControl.js","chessBoard/reducer.js","chessBoard/views/chessBoard.js","player/reducer.js","player/views/playerZone.js","player/views/cardItem.js","player/views/publicZone.js","player/views/gameBoard.js","App.js","Store.js","index.js"],"names":["RESET","UPDATE_SOCKET","ChessTypes","NONE","NORMAL","findChessPos","board","chessId","selectPos","i","length","row","j","id","x","y","createChess","player","chessType","type","createBearFrogBoard","getInitState","players","name","order","local","nowPlayer","chessBoard","selected","selectId","gameControl","socketContainer","this","socketClient","setSocketClient","bind","getSocketClient","s","SELECT","MOVE_TO","SET_BOARD","setBoard","SocketAPI","host","ws","WebSocket","onclose","e","alert","onerror","disconnect","data","send","JSON","stringify","func","onmessage","onopen","gameMessage","isRoundEnd","needMessage","setLocalPlayer","flatten","arr","reduce","pre","val","concat","Array","isArray","getNextPosList","maxX","maxY","gx","gy","moveList","x2","y2","push","judgeCanBeMoveTo","indexOf","doMoveAction","now","newBoard","map","item","temp","typeChangeInfo","reason","isHorizon","ii","allLength","maxAllLength","selfLength","maxSelfLength","selfSize","enemyList","jj","Math","max","doKill","judgeGameOver","orderSequence","flatBoard","playerChessCount","key","gameOver","winners","parseInt","playerCanMoveCount","forEach","overs","Object","keys","console","log","ChessComponent","props","iconClassName","children","className","xmlns","width","height","viewBox","dominantBaseline","textAnchor","style","fontSize","ChessItem","context","state","nextProps","beSelected","canBeMoveTo","onSelect","onMoveTo","canBeSelect","onClick","React","Component","connect","AI","getTheMove","moves","one","next","min","ceil","floor","random","getNextBoard","theMove","AIClient","funcs","onMessage","onOpen","setTimeout","resData","PlayControl","roomId","vsAI","process","SocketClient","setOnOpen","setOnMessage","event","parse","onReceiveBoard","preGameOver","resetAll","dispatch","setNowPlayer","buttonList","title","url","urlFunc","randomNumber","menuPage","buttonData","Button","raised","history","OnePlayerPanel","playerName","value","readOnly","text","onCopy","onJump","RoomMenu","window","location","href","pathname","urlPrefix","split","outlined","RouteControl","playControl","match","params","playerId","hasAI","Switch","Route","path","component","exact","select","moveTo","rowKey","index","PlayerZone","ownProps","active","game","cardPlayed","isShow","onRemove","typeShow","backgroundColor","render","preProps","isNowPlayer","onRemoveCard","isComputer","cards","life","noCard","str","from","nowPlayerName","roundEnd","App","win","reducer","combineReducers","action","newState","nextState","filter","todoItem","storeEnhancers","compose","applyMiddleware","devToolsExtension","f","createStore","ReactDOM","store","document","getElementById"],"mappings":"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","file":"static/js/main.ca4d2edb.chunk.js","sourcesContent":["export const RESET = 'GAME_CONTROL/RESET';\r\nexport const UPDATE_SOCKET = 'GAME_CONTROL/UPDATE_SOCKET';\r\n","export const ChessTypes = {\r\n  NONE: '无棋',\r\n  NORMAL: '有棋',\r\n};\r\n","/**\r\n * Created by yuiff on 2018/3/31.\r\n */\r\nimport { ChessTypes } from '../constants.js';\r\n\r\nconst findChessPos = (board, chessId) => {\r\n  let selectPos = {};\r\n  for (let i = 0; i < board.length; i++) {\r\n    const row = board[i];\r\n    for (let j = 0; j < row.length; j++) {\r\n      // console.log(typeof(i), typeof(j));\r\n      const item = row[j];\r\n      if (item.id === chessId) {\r\n        selectPos = {\r\n          x: i,\r\n          y: j,\r\n        };\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  // console.log(selectPos, chessId, board, typeof(selectPos.x), typeof(selectPos.y));\r\n  return selectPos;\r\n};\r\n\r\nlet chessId = 0;\r\nconst createChess = (player, chessType) => ({\r\n  id: chessId++,\r\n  player,\r\n  type: chessType,\r\n});\r\n\r\nconst createBearFrogBoard = () => {\r\n  const board = [\r\n    [createChess(1, ChessTypes.NORMAL), createChess(1, ChessTypes.NORMAL), createChess(1, ChessTypes.NORMAL), createChess(1, ChessTypes.NORMAL)],\r\n    [createChess(1, ChessTypes.NORMAL), createChess(null, ChessTypes.NONE), createChess(null, ChessTypes.NONE), createChess(1, ChessTypes.NORMAL)],\r\n    [createChess(0, ChessTypes.NORMAL), createChess(null, ChessTypes.NONE), createChess(null, ChessTypes.NONE), createChess(0, ChessTypes.NORMAL)],\r\n    [createChess(0, ChessTypes.NORMAL), createChess(0, ChessTypes.NORMAL), createChess(0, ChessTypes.NORMAL), createChess(0, ChessTypes.NORMAL)],\r\n  ];\r\n  return board;\r\n};\r\n\r\nconst getInitState = () => {\r\n  const initValues = {\r\n    player: {\r\n      players: [\r\n        {\r\n          name: '黑方',\r\n        },\r\n        {\r\n          name: '红方',\r\n        },\r\n      ],\r\n      order: [0, 1],\r\n      local: [0, 1],\r\n      nowPlayer: 0,\r\n    },\r\n    chessBoard: {\r\n      board: createBearFrogBoard(),\r\n      selected: false,\r\n      selectId: -1,\r\n    },\r\n    gameControl: {\r\n    },\r\n  };\r\n  return initValues;\r\n};\r\n\r\nclass SocketContainerClass{\r\n  constructor(){\r\n    this.socketClient = null;\r\n    this.setSocketClient = this.setSocketClient.bind(this);\r\n    this.getSocketClient = this.getSocketClient.bind(this);\r\n  }\r\n  setSocketClient(s) {\r\n    this.socketClient = s;\r\n  }\r\n  getSocketClient () {return this.socketClient}\r\n}\r\n\r\nconst socketContainer = new SocketContainerClass();\r\n\r\nexport { findChessPos, createBearFrogBoard, getInitState, socketContainer };\r\n","import { RESET, UPDATE_SOCKET } from './actionTypes.js';\r\nimport { ChessTypes } from '../constants.js';\r\nimport { getInitState } from '../utils/';\r\n\r\nexport default (state = ChessTypes.NONE, action) => {\r\n  switch (action.type) {\r\n    case RESET: {\r\n      //好像写的不对，也没用上\r\n      console.log('RESET!', getInitState());\r\n      return getInitState();\r\n    }\r\n    case UPDATE_SOCKET: {\r\n      //这个好像，也没用上，这个东西都不放在store里了\r\n      console.log('UPDATE_SOCKET!', action.socketClient);\r\n      const { socketClient } = action;\r\n      return {\r\n        ...state,\r\n        socketClient,\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","export const SELECT = 'CHESS_BOARD/SELECT';\r\nexport const MOVE_TO = 'CHESS_BOARD/MOVE_TO';\r\nexport const SET_BOARD = 'CHESS_BOARD/SET_BOARD';\r\n","import { SELECT, MOVE_TO, SET_BOARD } from './actionTypes.js';\r\n\r\nexport const select = id => ({\r\n  type: SELECT,\r\n  id,\r\n});\r\n\r\nexport const moveTo = id => ({\r\n  type: MOVE_TO,\r\n  id,\r\n});\r\n\r\nexport const setBoard = board => ({\r\n  type: SET_BOARD,\r\n  board,\r\n});\r\n","// const host = 'http://localhost:3000';\n// const socketPath = '/socket';\n\nexport default class SocketAPI {\n  ws;\n\n  connect(host) {\n    this.ws = new WebSocket(host);\n    this.ws.onclose = (e) => {\n      alert('webSocket onClose!' + e);\n    };\n    this.ws.onerror = (e) => {\n      alert('webSocket onError!' + e);\n    };\n  }\n\n  disconnect() {\n    this.ws.disconnect();//待确认，乱写的\n  }\n\n  send(data) {\n    this.ws.send(JSON.stringify(data));\n  }\n\n  setOnMessage(func) {\n    this.ws.onmessage = func;\n  }\n\n  setOnOpen(func) {\n    this.ws.onopen = func;\n  }\n\n  // on(event, fun) {\n  //     // No promise is needed here, but we're expecting one in the middleware.\n  //     return new Promise((resolve, reject) => {\n  //         if (!this.socket) return reject('No socket connection.');\n  //\n  //         this.socket.on(event, fun);\n  //         resolve();\n  //     });\n  // }\n}\n// board棋盘，nowPlayer当前回合人（0/1）， isRoundEnd不懂是啥，needMessage是否需要立刻获取棋盘信息，例如刚上线首次获取棋盘的在线人\nconst gameMessage = (board, nowPlayer, isRoundEnd = false, needMessage = false) => {\n  return {\n    board,\n    nowPlayer,\n    isRoundEnd,\n    needMessage\n  };\n};\n\nexport { gameMessage };\n","import { SET_LOCAL_PLAYER, ROUND_END } from './actionTypes.js';\r\n\r\nexport const setLocalPlayer = (local, nowPlayer) => ({\r\n  type: SET_LOCAL_PLAYER,\r\n  local,\r\n  nowPlayer,\r\n});\r\n\r\nexport const roundEnd = () => ({\r\n  type: ROUND_END,\r\n});\r\n","export const SET_LOCAL_PLAYER = 'PLAYER/PLAY';\r\nexport const ROUND_END = 'PLAYER/ROUND_END';\r\n","import {ChessTypes} from \"../constants\";\r\nimport {findChessPos} from \"./index\";\r\n\r\nexport const flatten = arr => arr.reduce((pre, val) => pre.concat(Array.isArray(val) ? flatten(val) : val), []);\r\n\r\nexport function getNextPosList(board, x, y) {\r\n  const maxX = board.length;\r\n  const maxY = board[0].length;\r\n  const gx = [0, 0, -1, 1];\r\n  const gy = [1, -1, 0, 0];\r\n  const moveList = [];\r\n  for (const i in gx) {\r\n    const x2 = x + gx[i];\r\n    const y2 = y + gy[i];\r\n    // console.log(x, y, gx[i], gy[i], x2, y2, maxX, maxY, typeof(x), typeof(gx[i]));\r\n    if (x2 >= 0 && x2 < maxX && y2 >= 0 && y2 < maxY && board[x2][y2].type === ChessTypes.NONE) {\r\n      moveList.push(board[x2][y2].id);\r\n    }\r\n  }\r\n  return moveList;\r\n}\r\n\r\n\r\nexport const judgeCanBeMoveTo = ({board, selectId, selected}, chessId) => {\r\n  if (!selected) return false;\r\n  const {x, y} = findChessPos(board, selectId);\r\n  const moveList = getNextPosList(board, x, y);\r\n  // console.log(moveList.indexOf(chessId) !== -1);\r\n  return moveList.indexOf(chessId) !== -1;\r\n};\r\n\r\nexport function doKill(board, x, y, player) {\r\n  for (let isHorizon = 0; isHorizon < 2; isHorizon++) {\r\n    let maxX = board.length;\r\n    let maxY = board[0].length;\r\n    if (isHorizon) [maxX, maxY] = [maxY, maxX];\r\n    const ii = isHorizon ? x : y;\r\n\r\n    let allLength = 0,\r\n      maxAllLength = 0;\r\n    let selfLength = 0,\r\n      maxSelfLength = 0,\r\n      selfSize = 0;\r\n    const enemyList = [];\r\n    for (let jj = 0; jj < maxY; jj++) {\r\n      const [i, j] = isHorizon ? [ii, jj] : [jj, ii];\r\n      const now = board[i][j];\r\n      if (now.type != ChessTypes.NONE) {\r\n        allLength++;\r\n        maxAllLength = Math.max(allLength, maxAllLength);\r\n        if (now.player === player) {\r\n          selfLength++;\r\n          maxSelfLength = Math.max(selfLength, maxSelfLength);\r\n          selfSize++;\r\n        } else {\r\n          enemyList.push(now);\r\n          selfLength = 0;\r\n        }\r\n      } else {\r\n        allLength = 0;\r\n        selfLength = 0;\r\n      }\r\n    }\r\n    if (maxAllLength == 3 && maxSelfLength == 2 && selfSize == 2 && enemyList.length == 1) {\r\n      for (let j = 0; j < enemyList.length; j++) {\r\n        enemyList[j].type = ChessTypes.NONE;\r\n        enemyList[j].typeChangeInfo = {reason: \"DIE\"};\r\n        enemyList[j].player = -1;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 从now: {x,y}移动一个棋到x,y，计算kill操作\r\nexport function doMoveAction(board, now, x, y) {\r\n  const newBoard = board.map(row =>\r\n    row.map(item => ({...item})));\r\n  // (now.x,now.y) move to x,y\r\n  const temp = newBoard[now.x][now.y];\r\n  newBoard[now.x][now.y] = newBoard[x][y];\r\n  newBoard[x][y] = temp;\r\n\r\n  newBoard[now.x][now.y].typeChangeInfo = {reason: \"LEAVE\", x, y};\r\n  newBoard[x][y].typeChangeInfo = {reason: \"ARRIVE\", x: now.x, y: now.y};\r\n\r\n  const player = newBoard[x][y].player;\r\n  newBoard[now.x][now.y].player = player; //因为目前的动画会根据棋子的player来画棋子，死亡动画要用到这个空格，所以这里要打个这个补丁。虽然不太合适\r\n  doKill(newBoard, x, y, player);\r\n  return newBoard;\r\n}\r\n\r\n\r\nexport function judgeGameOver(board, player = {\r\n  players: [{name: 'A'}, {name: 'B'}],\r\n  order: [0, 1]\r\n}, orderSequence = [0, 1]) {\r\n  const flatBoard = flatten(board);\r\n\r\n  const playerChessCount = {...orderSequence};\r\n  for (const key in playerChessCount) playerChessCount[key] = 0;\r\n  for (const i in flatBoard) {\r\n    flatBoard[i].type=== ChessTypes.NORMAL && playerChessCount[flatBoard[i].player]++;\r\n  }\r\n\r\n  const {players, order} = player;\r\n  let gameOver = false;\r\n  let winners = [];\r\n  // 判断是否只剩1棋，输掉\r\n  for (const key in playerChessCount) {\r\n    if (playerChessCount[key] <= 1) {\r\n      gameOver = true;\r\n    } else if (players[parseInt(key)]) winners.push(players[parseInt(key)].name);\r\n  }\r\n  if (!gameOver) {\r\n    // 判断是否无棋可走，输掉\r\n    winners = [];\r\n    const playerCanMoveCount = {...order};\r\n    for (const key in playerCanMoveCount) playerCanMoveCount[key] = {};\r\n    for (let i = 0; i < board.length; i++) {\r\n      for (let j = 0; j < board[i].length; j++) {\r\n        if (board[i][j].type === ChessTypes.NORMAL) {\r\n          const moveList = getNextPosList(board, i, j);\r\n          const player = board[i][j].player;\r\n          moveList.forEach((id) => {\r\n            playerCanMoveCount[player][id] = true;\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    const overs = {};\r\n    for (const key in playerCanMoveCount) {\r\n      if (Object.keys(playerCanMoveCount[key]) <= 0) {\r\n        gameOver = true;\r\n        if (players[parseInt(key)]) overs[key] = true;\r\n      }\r\n    }\r\n    if (gameOver)\r\n      for (const key in playerCanMoveCount) {\r\n        console.log(key, playerCanMoveCount[key], overs[key]);\r\n        if (players[parseInt(key)] && !overs[key]) winners.push(players[parseInt(key)].name);\r\n      }\r\n    console.log(\"playerCanMoveCount\", board, playerCanMoveCount, overs);\r\n  }\r\n  return {\r\n    gameOver,\r\n    winners\r\n  };\r\n}\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {connect} from 'react-redux';\r\n// import MdAccessibility from 'react-icons/lib/md/accessibility';\r\nimport {GiBearFace, GiFrogPrince} from 'react-icons/gi'\r\n// import MdAccessible from 'react-icons/lib/md/accessible';\r\n// import MdPets from 'react-icons/lib/md/pets';\r\n// import * as FontAwesome from 'react-icons/lib/fa'\r\nimport {ChessTypes} from '../../constants.js';\r\nimport {findChessPos} from '../../utils';\r\nimport {judgeCanBeMoveTo, getNextPosList} from \"../../utils/boardUtils\";\r\n\r\nconst ChessComponent = (props)=>{\r\n  const {iconClassName, children} = props;\r\n  // return <div className={iconClassName} style={{background: 'red'}}><MdAccessibility className={iconClassName}/>🐻</div>\r\n  return <div className={`${iconClassName}`}>\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox='0 0 512 512'>\r\n        <text x='50%' y=\"50%\" dominantBaseline=\"central\" textAnchor=\"middle\" style={{fontSize: \"256px\"}} >\r\n          {children}\r\n        </text>\r\n    </svg>\r\n    </div>\r\n  ;\r\n}\r\n\r\nclass ChessItem extends React.Component {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.state = {}\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n  }\r\n\r\n  render() {\r\n    const {player, type, beSelected, canBeMoveTo, onSelect, onMoveTo, canBeSelect, typeChangeInfo} = this.props;\r\n    const onClick = () => {\r\n      if (canBeMoveTo) {\r\n        onMoveTo();\r\n      } else if (type != ChessTypes.NONE && canBeSelect) {\r\n        onSelect();\r\n      }\r\n    };\r\n    let iconClassName = `chess-item ${player == 1 ? 'enemy' : ''} `;\r\n    if (type === ChessTypes.NONE) {\r\n      if (typeChangeInfo === \"LEAVE\")\r\n        iconClassName += 'leave ';\r\n      else if (typeChangeInfo === \"DIE\") {\r\n        iconClassName += 'die ';\r\n      } else {\r\n        iconClassName += 'normal-none  ';\r\n      }\r\n    } else {\r\n      if (typeChangeInfo === \"ARRIVE\") {\r\n        iconClassName += 'arrive ';\r\n      } else {\r\n        iconClassName += 'normal-display ';\r\n      }\r\n    }\r\n\r\n    let icon = null;\r\n    if (player == 0)\r\n      icon = null;\r\n    else\r\n      icon = <GiBearFace className={iconClassName}/>;\r\n    return (\r\n      <div\r\n        className={`chess-block ${beSelected ? 'selected' : ''} ${canBeMoveTo ? 'can-be-move-to' : ''} ${canBeSelect && !beSelected ? 'can-be-select' : ''} `}\r\n        onClick={onClick}>\r\n        <ChessComponent iconClassName={iconClassName}>{player===0?'🐻':'🐸'}</ChessComponent>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n// TodoItem.propTypes = {\r\n//   onToggle: PropTypes.func.isRequired,\r\n//   onRemove: PropTypes.func.isRequired,\r\n//   completed: PropTypes.bool.isRequired,\r\n//   text: PropTypes.string.isRequired\r\n// }\r\n\r\n\r\nconst mapStateToProps = (state, {chessId, player, type}) => ({\r\n  beSelected: state.chessBoard.selected && state.chessBoard.selectId == chessId,\r\n  canBeMoveTo: judgeCanBeMoveTo(state.chessBoard, chessId),\r\n  canBeSelect: state.player.nowPlayer === player && state.player.local.indexOf(player) != -1 && type === ChessTypes.NORMAL,\r\n});\r\n\r\nexport default connect(mapStateToProps)(ChessItem);\r\nexport { getNextPosList };\r\n","import {doMoveAction, getNextPosList} from \"../boardUtils\";\r\nimport {ChessTypes} from \"../../constants\";\r\nimport {findChessPos} from \"../index\";\r\n\r\n/**\r\n * Returns a random integer between min (inclusive) and max (inclusive).\r\n * The value is no lower than min (or the next integer greater than min\r\n * if min isn't an integer) and no greater than max (or the next integer\r\n * lower than max if max isn't an integer).\r\n * Using Math.round() will give you a non-uniform distribution!\r\n */\r\nfunction getRandomInt(min, max) {\r\n  min = Math.ceil(min);\r\n  max = Math.floor(max);\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nconst AI = {\r\n  getTheMove: function (board, player) {\r\n    const moves = [];\r\n    for (let i = 0; i < board.length; i++) {\r\n      for (let j = 0; j < board[i].length; j++) {\r\n        if (board[i][j].type === ChessTypes.NORMAL && board[i][j].player === player) {\r\n          const moveList = getNextPosList(board, i, j);\r\n          moveList.forEach(one => {\r\n            moves.push({now: board[i][j].id, next: one}); //存现在的和next的id\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    const theMove = moves[getRandomInt(0, moves.length - 1)];\r\n    return theMove;\r\n  },\r\n  getNextBoard: (board, player) => {\r\n    //id: 16, player: 1, type: \"有棋\"\r\n    //{id: 25, player: null, type: \"无棋\"}\r\n    console.log(\"AI getNextBoard board?!\", board, player);\r\n\r\n    // const flatBoard = flatten(board);\r\n    // const canMoveChesses = flatBoard.filter(one=>one.player===player);\r\n    const theMove = AI.getTheMove(board, player);\r\n\r\n    let newBoard = board;\r\n    if (theMove) {\r\n      const now = findChessPos(board, theMove.now);\r\n      const next = findChessPos(board, theMove.next);\r\n      console.log(\"getNextBoard theMove\", theMove, now, next);\r\n      newBoard = doMoveAction(board, now, next.x, next.y);\r\n    }\r\n\r\n    return newBoard;\r\n  }\r\n};\r\n\r\nexport default AI;\r\n","// const host = 'http://localhost:3000';\n// const socketPath = '/socket';\n\nimport AI from \"../ai/ai\";\nimport {judgeGameOver} from \"../boardUtils\";\n\nexport default class AIClient {\n  funcs={\n    onMessage: ()=>{},\n    onOpen: ()=>{}\n  }\n  connect(host) {\n    const data = {};\n    // this.funcs.onOpen(data);\n  }\n\n  disconnect() {\n\n  }\n\n  send(data) {\n    // this.ws.send(JSON.stringify(data));\n    console.log(\"AIClient send\", data);\n    setTimeout(()=>{\n      const {nowPlayer, isRoundEnd} = data; // nowPlayer好像经常是null，那边没好好传过来，待修复\n\n      if(judgeGameOver(data.board).gameOver) return; //游戏已经结束的话，就不用计算了\n\n      const realNowPlayer = 1;\n      const newNowPlayer = 0;\n      const resData = {\n        board: AI.getNextBoard(data.board, 1),\n        isRoundEnd: false,\n        needMessage: false,\n        nowPlayer: newNowPlayer\n      };\n      this.funcs.onMessage({data: JSON.stringify(resData)});\n    }, 1000);\n  }\n\n  setOnMessage(func) {\n    // this.ws.onmessage = func;\n    this.funcs.onMessage = func;\n  }\n\n  setOnOpen(func) {\n    // this.ws.onopen = func;\n    this.funcs.onOpen = func;\n  }\n}\n","import React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport './style.css';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\nimport {setBoard} from '../../chessBoard/actions.js';\r\nimport {reset, updateSocket} from '../actions.js';\r\nimport SocketClient, {gameMessage} from '../../utils/controlClients/SocketClient';\r\nimport {roundEnd, setLocalPlayer} from '../../player/actions';\r\nimport {moveTo} from '../../chessBoard/actions';\r\nimport {socketContainer} from '../../utils';\r\nimport {getNextPosList} from '../../chessBoard/views/chessItem';\r\nimport {ChessTypes} from '../../constants';\r\nimport AIClient from \"../../utils/controlClients/AIClient\";\r\nimport {flatten, judgeGameOver} from \"../../utils/boardUtils\";\r\n\r\nclass PlayControl extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    console.log('PlayControl　constructor', props);\r\n    const {roomId, vsAI, player} = props;\r\n    this.props.setBoard();\r\n    if (props.roomId || vsAI) {\r\n      this.props.setLocalPlayer([parseInt(props.player)]);\r\n\r\n      const host = process.env.REACT_APP_WS_HOST + props.roomId;\r\n      const GameClient = vsAI ? AIClient : SocketClient;\r\n      const socketClient = new GameClient();\r\n      socketClient.connect(host);\r\n      socketClient.setOnOpen(() => {\r\n        socketClient.send(gameMessage(null, null, null, true));\r\n      });\r\n      socketClient.setOnMessage((event) => {\r\n        console.log(event, event.data, JSON.parse(event.data));\r\n        // alert(event.data);\r\n        const data = JSON.parse(event.data);\r\n        if (data.needMessage) {\r\n          const {board, nowPlayer, gameOver} = this.props;\r\n          if (!gameOver) socketClient.send(gameMessage(board, nowPlayer, false));\r\n        } else {\r\n          props.onReceiveBoard(data);\r\n        }\r\n      });\r\n      socketContainer.setSocketClient(socketClient);\r\n    } else {\r\n      this.props.setLocalPlayer([0, 1]);\r\n      socketContainer.setSocketClient(null);\r\n    }\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    const {gameOver: preGameOver} = this.props;\r\n    const {gameOver, winners} = nextProps;\r\n    console.log('judge gameOver! ', this.props, gameOver, preGameOver);\r\n    if (gameOver && !preGameOver) {\r\n      // 延迟gameOver弹框，防止看不到最后一步。不过没有立即禁止操作，可能要再优化下\r\n      setTimeout(()=>{\r\n        alert(`游戏结束！胜者是${winners}`);\r\n        // window.location.reload();\r\n        nextProps.resetAll();\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      chessBoard, player, gameOver, roomId,\r\n    } = this.props;\r\n\r\n    return (\r\n      <div className=\"full-window\">\r\n        <div className=\"inner-window\">\r\n          {roomId ? <div>房间{roomId}</div> : ''}\r\n          <div>{chessBoard}</div>\r\n          <div>{player}</div>\r\n          <div>规则：本回合移动的己方棋子和其移动后相邻的棋子，两个棋子组成炮台，杀死处在该炮台连线上相邻的敌方棋子。如果这条直线上有4个棋子则杀不掉。当有玩家只剩1颗棋子或者无法行动时输掉。</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n  const board = state.chessBoard.board;\r\n\r\n  const {gameOver, winners} = judgeGameOver(board, state.player, state.player.order);\r\n  // console.log(flatBoard, gameOver);\r\n  return {\r\n    gameOver,\r\n    winners: gameOver ? winners : [],\r\n    board,\r\n    nowPlayer: state.player.nowPlayer,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  setLocalPlayer: (local) => {\r\n    dispatch(setLocalPlayer(local));\r\n  },\r\n  setNowPlayer: (nowPlayer) => {\r\n    dispatch(setLocalPlayer(null, nowPlayer));\r\n  },\r\n  setBoard: (board) => {\r\n    dispatch(setBoard(board));\r\n  },\r\n  resetAll: () => {\r\n    dispatch(setBoard());\r\n  },\r\n  onReceiveBoard: (data) => {\r\n    const {board, nowPlayer, isRoundEnd} = data;\r\n    console.log('will dispatch, board=', board, nowPlayer, isRoundEnd);\r\n    dispatch(setBoard(board));\r\n    if (nowPlayer || nowPlayer === 0) dispatch(setLocalPlayer(null, nowPlayer));\r\n    if (isRoundEnd) dispatch(roundEnd());\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PlayControl);\r\n","import React, {Component} from 'react';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\n\r\nimport \"./menuPage.scss\";\r\nimport Button from '@material-ui/core/Button';\r\n\r\nconst buttonList = [\r\n  {title: '单挑AI', url: '/local-ai/1/0'},\r\n  {title: '本地双人', url: '/local'},\r\n  // {title: '在线双人-南位', url: '/online/123/0'},\r\n  // {title: '在线双人-北位', url: '/online/123/1'},\r\n  {\r\n    title: '网络对战', urlFunc: () => {\r\n      const randomNumber = Math.floor(Math.random() * 1000000 + 1);\r\n      return `/room/${randomNumber}`\r\n    }\r\n  },\r\n];\r\n\r\nconst menuPage = (props) => (<div className=\"menu-page\">\r\n  <div className={\"title-field\"}>\r\n    <div className=\"page-title\">\r\n      熊蛙棋\r\n    </div>\r\n  </div>\r\n  <div className=\"right-field\">\r\n    <div className=\"page-select-list\">\r\n      {buttonList.map(buttonData => {\r\n        const {title, url, urlFunc} = buttonData;\r\n        return <div>\r\n          <Button\r\n            raised className=\"mdc-button my-button\" onClick={() => {\r\n            if (urlFunc) props.history.push(urlFunc());\r\n            else props.history.push(url);\r\n          }}>\r\n            {title}\r\n          </Button></div>\r\n      })}\r\n    </div>\r\n  </div>\r\n  {/* <div><Link to=\"/\">主菜单</Link></div> */}\r\n</div>);\r\n\r\nexport default menuPage;\r\n","import React, {Component} from 'react';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\n\r\nimport \"./RoomMenu.scss\";\r\nimport Button from '@material-ui/core/Button';\r\nimport {CopyToClipboard} from \"react-copy-to-clipboard\";\r\n\r\nconst buttonList = [\r\n  {title: '玩家1进入', urlFunc: (roomId, playerId) => `/online/${roomId}/${playerId}`},\r\n  {title: '玩家2进入', urlFunc: (roomId, playerId) => `/online/${roomId}/${playerId}`},\r\n];\r\n\r\nconst OnePlayerPanel = (props) => {\r\n  const {playerName, url} = props;\r\n  return <div className='one-player-panel'>\r\n    <div>{playerName}</div>\r\n    <div>\r\n      <input className='my-input' value={url} readOnly={true}/>\r\n      <CopyToClipboard text={url}\r\n                       onCopy={() => {\r\n                       }}>\r\n        <button className='copy-button' onClick={() => {\r\n        }}>复制网址\r\n        </button>\r\n      </CopyToClipboard>\r\n    </div>\r\n    <Button\r\n      raised className=\"enter-button\" onClick={() => {\r\n      props.onJump && props.onJump();\r\n    }}>{`进入${playerName}座位`}</Button>\r\n  </div>\r\n};\r\n\r\nconst RoomMenu = (props) => {\r\n  const {history, roomId} = props;\r\n  const {host, href, pathname} = window.location;\r\n  console.log(\"location!\", props.location, window.location);\r\n  const urlPrefix = href.split('#')[0];\r\n  return (<div className=\"menu-page\">\r\n    <div className={\"title-field\"}>\r\n      <div className=\"page-info\">\r\n        网络1V1对战：把一个座位的网址发给朋友，自己进入另一个座位网址。\r\n      </div>\r\n      <div><Button outlined className=\"back-button\" onClick={() => {\r\n        props.history.push(`/`);\r\n      }}>返回主菜单</Button></div>\r\n    </div>\r\n    <div className=\"right-field\">\r\n      <div className=\"player-copy-field\">\r\n        <OnePlayerPanel playerName={\"玩家1\"} url={`${urlPrefix}#/online/${roomId}/${0}`} onJump={() => {\r\n          props.history.push(`/online/${roomId}/${0}`);\r\n        }}/>\r\n        <OnePlayerPanel playerName={\"玩家2\"} url={`${urlPrefix}#/online/${roomId}/${1}`} onJump={() => {\r\n          props.history.push(`/online/${roomId}/${1}`);\r\n        }}/>\r\n      </div>\r\n    </div>\r\n  </div>);\r\n}\r\n\r\nexport default RoomMenu;\r\n","/**\r\n * Created by yuiff on 2018/4/1.\r\n */\r\nimport React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport './style.css';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\nimport PlayControl from './gamePlaying.js';\r\nimport menuPage from \"../../menu/menuPage\";\r\nimport RoomMenu from \"../../menu/RoomMenu\";\r\n\r\nclass RouteControl extends Component {\r\n  render() {\r\n    const {chessBoard, player, gameOver} = this.props;\r\n    const playControl = ({match, ...others}) => {\r\n      // console.log(\"playControl\", match, others, this.props);\r\n      return <PlayControl {...this.props} roomId={match.params.roomId}\r\n                   player={match.params.playerId} vsAI={match.params.hasAI}/>;\r\n    }\r\n    const roomControl = (props) => {\r\n      const {match} = props;\r\n      return <RoomMenu {...props} roomId={match.params.roomId}/>\r\n    };\r\n    return (\r\n      <div className=\"full-window\">\r\n        <div className=\"inner-window\">\r\n          <Switch>\r\n            <Route path=\"/local\" component={playControl}/>\r\n            <Route path=\"/local-ai/:hasAI/:playerId\" component={playControl} />\r\n            <Route path=\"/online/:roomId/:playerId\" component={playControl}/>\r\n            <Route exact path=\"/\" component={menuPage}/>\r\n            <Route path=\"/room/:roomId\" component={roomControl}/>\r\n          </Switch>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = state => ({});\r\n\r\n\r\nexport default connect(mapStateToProps)(RouteControl);\r\n","import {SELECT, MOVE_TO, SET_BOARD} from './actionTypes.js';\r\nimport {findChessPos, socketContainer} from '../utils';\r\nimport {ChessTypes} from '../constants.js';\r\nimport {createBearFrogBoard} from '../utils/';\r\nimport {gameMessage} from '../utils/controlClients/SocketClient';\r\nimport {doMoveAction} from \"../utils/boardUtils\";\r\n\r\nexport default (state = {}, action) => {\r\n  switch (action.type) {\r\n    case SELECT: {\r\n      console.log(action);\r\n      return {\r\n        ...state,\r\n        selected: true,\r\n        selectId: action.id,\r\n      };\r\n    }\r\n    case MOVE_TO: {\r\n      const now = findChessPos(state.board, state.selectId);\r\n      const {x, y} = findChessPos(state.board, action.id);\r\n      const board = state.board;\r\n      console.log(now.x, now.y, x, y, state.selectId, action.id, state.board);\r\n      const newBoard = doMoveAction(board, now, x, y);\r\n      if (socketContainer.getSocketClient()) {\r\n        socketContainer.getSocketClient()\r\n          .send(gameMessage(newBoard, null, true));\r\n      }\r\n      return {\r\n        ...state,\r\n        board: newBoard,\r\n        selected: false,\r\n      };\r\n    }\r\n    case SELECT: {\r\n      return state.filter(todoItem => todoItem.id !== action.id);\r\n    }\r\n    case SET_BOARD: {\r\n      console.log('SET_BOARD!REDUCER, got action:', action);\r\n      const board = action.board ? action.board : createBearFrogBoard();\r\n      return {\r\n        ...state,\r\n        board,\r\n      };\r\n    }\r\n    default: {\r\n      return state;\r\n    }\r\n  }\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { select, moveTo } from '../actions.js';\r\nimport { roundEnd } from '../../player/actions';\r\nimport ChessItem from './chessItem.js';\r\n\r\nimport './style.scss';\r\n\r\nconst ChessBoard = ({ board, onSelect, onMoveTo }) => {\r\n  let rowKey = 0;\r\n  return (\r\n    <div className=\"chess-board\">\r\n      {\r\n                board.map(row => (\r\n                  <div className=\"row\" key={rowKey++}>\r\n                    {row.map((item, index) => (\r\n                      <ChessItem\r\n                        key={index}\r\n                        chessId={item.id}\r\n                        player={item.player}\r\n                        type={item.type}\r\n                        onSelect={() => onSelect(item.id)}\r\n                        onMoveTo={() => onMoveTo(item.id)}\r\n                      />\r\n                        ))}\r\n                  </div>\r\n                ))\r\n            }\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  board: state.chessBoard.board,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onSelect: (id) => {\r\n    dispatch(select(id));\r\n  },\r\n  onMoveTo: (id) => {\r\n    dispatch(moveTo(id));\r\n    dispatch(roundEnd());\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChessBoard);\r\n\r\n","import { SET_LOCAL_PLAYER, ROUND_END } from './actionTypes.js';\r\n\r\n\r\nexport default (state = {}, action) => {\r\n  switch (action.type) {\r\n    case ROUND_END: {\r\n      const newState = {\r\n        ...state,\r\n        nowPlayer: state.order[(state.order.indexOf(state.nowPlayer) + 1) % state.order.length],\r\n      };\r\n      return newState;\r\n    }\r\n    case SET_LOCAL_PLAYER: {\r\n      const nextState = {\r\n        ...state,\r\n        nowPlayer: action.nowPlayer ? action.nowPlayer : 0,\r\n      };\r\n      if (action.local) { nextState.local = action.local; }\r\n      return nextState;\r\n    }\r\n    default: {\r\n      return state;\r\n    }\r\n  }\r\n};\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport { setLocalPlayer } from '../actions.js';\r\nimport CardItem from './cardItem.js';\r\n\r\nclass PlayerZone extends Component {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.render = this.render.bind(this);\r\n    this.state = {};\r\n  }\r\n\r\n  componentDidUpdate(preProps) {\r\n    const isNowPlayer = this.props.isNowPlayer;\r\n    const onRemoveCard = this.props.onRemoveCard;\r\n    const isComputer = this.props.isComputer;\r\n    const player = this.props.player;\r\n    const cards = this.props.cards;\r\n    const nowPlayer = this.props.nowPlayer;\r\n    const life = this.props.life;\r\n    console.log('AI', isNowPlayer, isComputer, player, nowPlayer);\r\n    if (isNowPlayer && isComputer && life > 0) {\r\n      const length = cards.length;\r\n      const selectCardIndex = Math.floor(Math.random() * length);\r\n      const selectCardId = cards[selectCardIndex].id;\r\n      onRemoveCard(selectCardId, player);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    // const cards = this.props.cards;\r\n    const player = this.props.player;\r\n    const life = this.props.life;\r\n    const onRemoveCard = this.props.onRemoveCard;\r\n    const noCard = this.props.noCard;\r\n    const isComputer = this.props.isComputer;\r\n    if (noCard && !isComputer) {\r\n      let str = `出完了！你还剩${life}星星，`;\r\n      if (life === 3) str += '能够全身而退，无敌。';\r\n      else if (life < 3) str += '不足3颗，完蛋了。';\r\n      else str += '赚到。';\r\n      alert(str);\r\n      if (life >= 3) window.location.href = 'http://www.yuiffy.com/hebi.html';\r\n      else window.location.href = 'http://www.yuiffy.com/mario.html';\r\n    }\r\n    return (\r\n      <div className=\"playerZone\">\r\n        {\r\n                    life <= 0 ?\r\n                      <div className=\"dead\">\r\n                            死了。\r\n                      </div>\r\n                        :\r\n                        // life!==0\r\n                      <div>\r\n                        {player}\r\n                        {/* <div className=\"cardZone\"> */}\r\n                        {/* { */}\r\n                        {/* cards.map((item) => ( */}\r\n                        {/* <CardItem */}\r\n                        {/* key={item.id} */}\r\n                        {/* type={item.type} */}\r\n                        {/* player={player} */}\r\n                        {/* onRemove={() => onRemoveCard(item.id, player)} */}\r\n                        {/* /> */}\r\n                        {/* )) */}\r\n                        {/* } */}\r\n                        {/* </div> */}\r\n                        <div className=\"lifeZone\">\r\n                          {\r\n                                    Array.from(Array(life), () => '★').map(item => (\r\n                                      <span>{item}</span>\r\n                                    ))\r\n                                }\r\n                        </div>\r\n                      </div>\r\n                }\r\n\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nPlayerZone.propTypes = {\r\n  cards: PropTypes.array.isRequired,\r\n  life: PropTypes.number.isRequired,\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n  cards: state.player.players[ownProps.player].cards,\r\n  life: state.player.players[ownProps.player].life,\r\n  noCard: false,\r\n  isComputer: state.player.players[ownProps.player].isComputer,\r\n  isNowPlayer: state.player.nowPlayer === ownProps.player,\r\n  nowPlayer: state.player.nowPlayer,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onRemoveCard: (id, player) => {\r\n    dispatch(setLocalPlayer(id, player));\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PlayerZone);\r\n\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\nimport { playCard } from '../actions.js';\r\n\r\nconst CardItem = ({\r\n  type, active, isShow, onRemove,\r\n}) => {\r\n  let typeShow = '';\r\n  switch (type) {\r\n    case 0:\r\n      typeShow = '石头';\r\n      break;\r\n    case 1:\r\n      typeShow = '剪刀';\r\n      break;\r\n    case 2:\r\n      typeShow = '布';\r\n      break;\r\n  }\r\n  return (\r\n    <div\r\n      className=\"card\"\r\n      onClick={active ? onRemove : null}\r\n      style={{\r\n                 backgroundColor: active ? 'yellow' : 'white',\r\n             }}\r\n    >\r\n      {active || isShow ? typeShow : ''}\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nCardItem.propTypes = {\r\n  type: PropTypes.string.isRequired,\r\n  active: PropTypes.bool.isRequired,\r\n  isShow: PropTypes.bool,\r\n  onClick: PropTypes.func.isRequired,\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n  active: state.game.nowPlayer === ownProps.player && state.game.players[ownProps.player].cardPlayed.length === 0,\r\n});\r\n\r\n\r\nexport default connect(mapStateToProps)(CardItem);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\n// import {bindActionCreators} from 'redux';\r\nimport CardItem from './cardItem.js';\r\nimport { playCard, showHand, roundEnd } from '../actions.js';\r\n// import {FilterTypes} from '../../constants.js';\r\n\r\nconst PublicZone = ({ nowPlayerName, roundEnd }) => (\r\n  <div className=\"\" onClick={roundEnd}>\r\n            现在轮到{nowPlayerName}行动\r\n  </div>\r\n);\r\n\r\nconst mapStateToProps = state => ({\r\n  nowPlayerName: state.player.players[state.player.nowPlayer].name,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  roundEnd: () => {\r\n    dispatch(roundEnd());\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PublicZone);\r\n\r\n","import React from 'react';\r\nimport PlayerZone from './playerZone.js';\r\nimport PublicZone from './publicZone.js';\r\n\r\nimport './style.css';\r\n\r\nexport default () => (\r\n  <div className=\"\">\r\n    <PublicZone />\r\n  </div>\r\n);\r\n\r\n","import React from 'react';\r\nimport { view as GameControl } from './gameControl/';\r\nimport { view as ChessBoard } from './chessBoard/';\r\nimport { view as Player } from './player/';\r\nimport { Link, Route, Switch } from 'react-router-dom';\r\n\r\nfunction App() {\r\n  const chessBoard = <ChessBoard />;\r\n  const player = <Player />;\r\n  return (\r\n    <GameControl chessBoard={chessBoard} player={player} />\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { createStore, combineReducers, applyMiddleware, compose } from 'redux';\r\n\r\nimport { reducer as playerReducer } from './player';\r\nimport { reducer as chessBoardReducer } from './chessBoard';\r\nimport { reducer as gameControlReducer } from './gameControl';\r\nimport { getInitState } from './utils/';\r\n\r\nconst win = window;\r\n\r\nconst reducer = combineReducers({\r\n  player: playerReducer,\r\n  chessBoard: chessBoardReducer,\r\n  gameControl: gameControlReducer,\r\n});\r\n\r\n\r\nconst middlewares = [];\r\nif (process.env.NODE_ENV !== 'production') {\r\n  middlewares.push(require('redux-immutable-state-invariant').default());\r\n}\r\n\r\nconst storeEnhancers = compose(\r\n  applyMiddleware(...middlewares),\r\n  (win && win.devToolsExtension) ? win.devToolsExtension() : f => f,\r\n);\r\n\r\nexport default createStore(reducer, getInitState(), storeEnhancers);\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport App from './App';\r\nimport { HashRouter as BrowserRouter } from 'react-router-dom';\r\n\r\nimport store from './Store.js';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <BrowserRouter>\r\n      <App />\r\n    </BrowserRouter>\r\n  </Provider>,\r\n  document.getElementById('root'),\r\n);\r\n"],"sourceRoot":""}