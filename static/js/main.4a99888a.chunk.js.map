{"version":3,"sources":["gameControl/actionTypes.js","constants.js","utils/index.js","gameControl/reducer.js","chessBoard/actionTypes.js","chessBoard/actions.js","utils/controlClients/SocketClient.js","player/actions.js","player/actionTypes.js","utils/boardUtils.js","chessBoard/views/chessItem.js","utils/ai/ai.js","utils/controlClients/AIClient.js","gameControl/views/gamePlaying.js","menu/menuPage.js","menu/RoomMenu.js","gameControl/views/routeControl.js","chessBoard/reducer.js","chessBoard/views/chessBoard.js","player/reducer.js","player/views/playerZone.js","player/views/cardItem.js","player/views/publicZone.js","player/views/gameBoard.js","App.js","Store.js","index.js"],"names":["RESET","UPDATE_SOCKET","ChessTypes","NONE","NORMAL","findChessPos","board","chessId","selectPos","i","length","row","j","id","x","y","createChess","player","chessType","type","createBearFrogBoard","getInitState","players","name","order","local","nowPlayer","chessBoard","selected","selectId","gameControl","socketContainer","this","socketClient","setSocketClient","bind","getSocketClient","s","SELECT","MOVE_TO","SET_BOARD","setBoard","SocketAPI","host","ws","WebSocket","onclose","e","alert","onerror","disconnect","data","send","JSON","stringify","func","onmessage","onopen","gameMessage","isRoundEnd","needMessage","setLocalPlayer","flatten","arr","reduce","pre","val","concat","Array","isArray","getNextPosList","maxX","maxY","gx","gy","moveList","x2","y2","push","judgeCanBeMoveTo","indexOf","doMoveAction","now","newBoard","map","item","temp","typeChangeInfo","reason","isHorizon","ii","allLength","maxAllLength","selfLength","maxSelfLength","selfSize","enemyList","jj","Math","max","doKill","judgeGameOver","orderSequence","flatBoard","playerChessCount","key","gameOver","winners","parseInt","playerCanMoveCount","forEach","overs","Object","keys","console","log","ChessItem","props","context","state","nextProps","beSelected","canBeMoveTo","onSelect","onMoveTo","canBeSelect","iconClassName","icon","className","onClick","React","Component","connect","AI","getTheMove","moves","one","next","min","ceil","floor","random","getNextBoard","theMove","AIClient","funcs","onMessage","onOpen","setTimeout","resData","PlayControl","roomId","vsAI","process","SocketClient","setOnOpen","setOnMessage","event","parse","onReceiveBoard","preGameOver","resetAll","dispatch","setNowPlayer","buttonList","title","url","urlFunc","randomNumber","menuPage","buttonData","Button","raised","history","OnePlayerPanel","playerName","value","readOnly","text","onCopy","onJump","RoomMenu","window","location","href","pathname","urlPrefix","split","outlined","RouteControl","playControl","match","params","playerId","hasAI","Switch","Route","path","component","exact","select","moveTo","rowKey","index","PlayerZone","ownProps","active","game","cardPlayed","isShow","onRemove","typeShow","style","backgroundColor","render","preProps","isNowPlayer","onRemoveCard","isComputer","cards","life","noCard","str","from","nowPlayerName","roundEnd","App","win","reducer","combineReducers","action","newState","nextState","filter","todoItem","storeEnhancers","compose","applyMiddleware","devToolsExtension","f","createStore","ReactDOM","store","document","getElementById"],"mappings":"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","file":"static/js/main.4a99888a.chunk.js","sourcesContent":["export const RESET = 'GAME_CONTROL/RESET';\r\nexport const UPDATE_SOCKET = 'GAME_CONTROL/UPDATE_SOCKET';\r\n","export const ChessTypes = {\r\n  NONE: '无棋',\r\n  NORMAL: '有棋',\r\n};\r\n","/**\r\n * Created by yuiff on 2018/3/31.\r\n */\r\nimport { ChessTypes } from '../constants.js';\r\n\r\nconst findChessPos = (board, chessId) => {\r\n  let selectPos = {};\r\n  for (let i = 0; i < board.length; i++) {\r\n    const row = board[i];\r\n    for (let j = 0; j < row.length; j++) {\r\n      // console.log(typeof(i), typeof(j));\r\n      const item = row[j];\r\n      if (item.id === chessId) {\r\n        selectPos = {\r\n          x: i,\r\n          y: j,\r\n        };\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  // console.log(selectPos, chessId, board, typeof(selectPos.x), typeof(selectPos.y));\r\n  return selectPos;\r\n};\r\n\r\nlet chessId = 0;\r\nconst createChess = (player, chessType) => ({\r\n  id: chessId++,\r\n  player,\r\n  type: chessType,\r\n});\r\n\r\nconst createBearFrogBoard = () => {\r\n  const board = [\r\n    [createChess(1, ChessTypes.NORMAL), createChess(1, ChessTypes.NORMAL), createChess(1, ChessTypes.NORMAL), createChess(1, ChessTypes.NORMAL)],\r\n    [createChess(1, ChessTypes.NORMAL), createChess(null, ChessTypes.NONE), createChess(null, ChessTypes.NONE), createChess(1, ChessTypes.NORMAL)],\r\n    [createChess(0, ChessTypes.NORMAL), createChess(null, ChessTypes.NONE), createChess(null, ChessTypes.NONE), createChess(0, ChessTypes.NORMAL)],\r\n    [createChess(0, ChessTypes.NORMAL), createChess(0, ChessTypes.NORMAL), createChess(0, ChessTypes.NORMAL), createChess(0, ChessTypes.NORMAL)],\r\n  ];\r\n  return board;\r\n};\r\n\r\nconst getInitState = () => {\r\n  const initValues = {\r\n    player: {\r\n      players: [\r\n        {\r\n          name: '黑方',\r\n        },\r\n        {\r\n          name: '红方',\r\n        },\r\n      ],\r\n      order: [0, 1],\r\n      local: [0, 1],\r\n      nowPlayer: 0,\r\n    },\r\n    chessBoard: {\r\n      board: createBearFrogBoard(),\r\n      selected: false,\r\n      selectId: -1,\r\n    },\r\n    gameControl: {\r\n    },\r\n  };\r\n  return initValues;\r\n};\r\n\r\nclass SocketContainerClass{\r\n  constructor(){\r\n    this.socketClient = null;\r\n    this.setSocketClient = this.setSocketClient.bind(this);\r\n    this.getSocketClient = this.getSocketClient.bind(this);\r\n  }\r\n  setSocketClient(s) {\r\n    this.socketClient = s;\r\n  }\r\n  getSocketClient () {return this.socketClient}\r\n}\r\n\r\nconst socketContainer = new SocketContainerClass();\r\n\r\nexport { findChessPos, createBearFrogBoard, getInitState, socketContainer };\r\n","import { RESET, UPDATE_SOCKET } from './actionTypes.js';\r\nimport { ChessTypes } from '../constants.js';\r\nimport { getInitState } from '../utils/';\r\n\r\nexport default (state = ChessTypes.NONE, action) => {\r\n  switch (action.type) {\r\n    case RESET: {\r\n      //好像写的不对，也没用上\r\n      console.log('RESET!', getInitState());\r\n      return getInitState();\r\n    }\r\n    case UPDATE_SOCKET: {\r\n      //这个好像，也没用上，这个东西都不放在store里了\r\n      console.log('UPDATE_SOCKET!', action.socketClient);\r\n      const { socketClient } = action;\r\n      return {\r\n        ...state,\r\n        socketClient,\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","export const SELECT = 'CHESS_BOARD/SELECT';\r\nexport const MOVE_TO = 'CHESS_BOARD/MOVE_TO';\r\nexport const SET_BOARD = 'CHESS_BOARD/SET_BOARD';\r\n","import { SELECT, MOVE_TO, SET_BOARD } from './actionTypes.js';\r\n\r\nexport const select = id => ({\r\n  type: SELECT,\r\n  id,\r\n});\r\n\r\nexport const moveTo = id => ({\r\n  type: MOVE_TO,\r\n  id,\r\n});\r\n\r\nexport const setBoard = board => ({\r\n  type: SET_BOARD,\r\n  board,\r\n});\r\n","// const host = 'http://localhost:3000';\n// const socketPath = '/socket';\n\nexport default class SocketAPI {\n  ws;\n\n  connect(host) {\n    this.ws = new WebSocket(host);\n    this.ws.onclose = (e) => {\n      alert('webSocket onClose!' + e);\n    };\n    this.ws.onerror = (e) => {\n      alert('webSocket onError!' + e);\n    };\n  }\n\n  disconnect() {\n    this.ws.disconnect();//待确认，乱写的\n  }\n\n  send(data) {\n    this.ws.send(JSON.stringify(data));\n  }\n\n  setOnMessage(func) {\n    this.ws.onmessage = func;\n  }\n\n  setOnOpen(func) {\n    this.ws.onopen = func;\n  }\n\n  // on(event, fun) {\n  //     // No promise is needed here, but we're expecting one in the middleware.\n  //     return new Promise((resolve, reject) => {\n  //         if (!this.socket) return reject('No socket connection.');\n  //\n  //         this.socket.on(event, fun);\n  //         resolve();\n  //     });\n  // }\n}\n// board棋盘，nowPlayer当前回合人（0/1）， isRoundEnd不懂是啥，needMessage是否需要立刻获取棋盘信息，例如刚上线首次获取棋盘的在线人\nconst gameMessage = (board, nowPlayer, isRoundEnd = false, needMessage = false) => {\n  return {\n    board,\n    nowPlayer,\n    isRoundEnd,\n    needMessage\n  };\n};\n\nexport { gameMessage };\n","import { SET_LOCAL_PLAYER, ROUND_END } from './actionTypes.js';\r\n\r\nexport const setLocalPlayer = (local, nowPlayer) => ({\r\n  type: SET_LOCAL_PLAYER,\r\n  local,\r\n  nowPlayer,\r\n});\r\n\r\nexport const roundEnd = () => ({\r\n  type: ROUND_END,\r\n});\r\n","export const SET_LOCAL_PLAYER = 'PLAYER/PLAY';\r\nexport const ROUND_END = 'PLAYER/ROUND_END';\r\n","import {ChessTypes} from \"../constants\";\r\nimport {findChessPos} from \"./index\";\r\n\r\nexport const flatten = arr => arr.reduce((pre, val) => pre.concat(Array.isArray(val) ? flatten(val) : val), []);\r\n\r\nexport function getNextPosList(board, x, y) {\r\n  const maxX = board.length;\r\n  const maxY = board[0].length;\r\n  const gx = [0, 0, -1, 1];\r\n  const gy = [1, -1, 0, 0];\r\n  const moveList = [];\r\n  for (const i in gx) {\r\n    const x2 = x + gx[i];\r\n    const y2 = y + gy[i];\r\n    // console.log(x, y, gx[i], gy[i], x2, y2, maxX, maxY, typeof(x), typeof(gx[i]));\r\n    if (x2 >= 0 && x2 < maxX && y2 >= 0 && y2 < maxY && board[x2][y2].type === ChessTypes.NONE) {\r\n      moveList.push(board[x2][y2].id);\r\n    }\r\n  }\r\n  return moveList;\r\n}\r\n\r\n\r\nexport const judgeCanBeMoveTo = ({board, selectId, selected}, chessId) => {\r\n  if (!selected) return false;\r\n  const {x, y} = findChessPos(board, selectId);\r\n  const moveList = getNextPosList(board, x, y);\r\n  // console.log(moveList.indexOf(chessId) !== -1);\r\n  return moveList.indexOf(chessId) !== -1;\r\n};\r\n\r\nexport function doKill(board, x, y, player) {\r\n  for (let isHorizon = 0; isHorizon < 2; isHorizon++) {\r\n    let maxX = board.length;\r\n    let maxY = board[0].length;\r\n    if (isHorizon) [maxX, maxY] = [maxY, maxX];\r\n    const ii = isHorizon ? x : y;\r\n\r\n    let allLength = 0,\r\n      maxAllLength = 0;\r\n    let selfLength = 0,\r\n      maxSelfLength = 0,\r\n      selfSize = 0;\r\n    const enemyList = [];\r\n    for (let jj = 0; jj < maxY; jj++) {\r\n      const [i, j] = isHorizon ? [ii, jj] : [jj, ii];\r\n      const now = board[i][j];\r\n      if (now.type != ChessTypes.NONE) {\r\n        allLength++;\r\n        maxAllLength = Math.max(allLength, maxAllLength);\r\n        if (now.player === player) {\r\n          selfLength++;\r\n          maxSelfLength = Math.max(selfLength, maxSelfLength);\r\n          selfSize++;\r\n        } else {\r\n          enemyList.push(now);\r\n          selfLength = 0;\r\n        }\r\n      } else {\r\n        allLength = 0;\r\n        selfLength = 0;\r\n      }\r\n    }\r\n    if (maxAllLength == 3 && maxSelfLength == 2 && selfSize == 2 && enemyList.length == 1) {\r\n      for (let j = 0; j < enemyList.length; j++) {\r\n        enemyList[j].type = ChessTypes.NONE;\r\n        enemyList[j].typeChangeInfo = {reason: \"DIE\"};\r\n        enemyList[j].player = -1;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 从now: {x,y}移动一个棋到x,y，计算kill操作\r\nexport function doMoveAction(board, now, x, y) {\r\n  const newBoard = board.map(row =>\r\n    row.map(item => ({...item})));\r\n  // (now.x,now.y) move to x,y\r\n  const temp = newBoard[now.x][now.y];\r\n  newBoard[now.x][now.y] = newBoard[x][y];\r\n  newBoard[x][y] = temp;\r\n\r\n  newBoard[now.x][now.y].typeChangeInfo = {reason: \"LEAVE\", x, y};\r\n  newBoard[x][y].typeChangeInfo = {reason: \"ARRIVE\", x: now.x, y: now.y};\r\n\r\n  const player = newBoard[x][y].player;\r\n  doKill(newBoard, x, y, player);\r\n  return newBoard;\r\n}\r\n\r\n\r\nexport function judgeGameOver(board, player = {\r\n  players: [{name: 'A'}, {name: 'B'}],\r\n  order: [0, 1]\r\n}, orderSequence = [0, 1]) {\r\n  const flatBoard = flatten(board);\r\n\r\n  const playerChessCount = {...orderSequence};\r\n  for (const key in playerChessCount) playerChessCount[key] = 0;\r\n  for (const i in flatBoard) {\r\n    playerChessCount[flatBoard[i].player]++;\r\n  }\r\n\r\n  const {players, order} = player;\r\n  let gameOver = false;\r\n  let winners = [];\r\n  // 判断是否只剩1棋，输掉\r\n  for (const key in playerChessCount) {\r\n    if (playerChessCount[key] <= 1) {\r\n      gameOver = true;\r\n    } else if (players[parseInt(key)]) winners.push(players[parseInt(key)].name);\r\n  }\r\n  if (!gameOver) {\r\n    // 判断是否无棋可走，输掉\r\n    winners = [];\r\n    const playerCanMoveCount = {...order};\r\n    for (const key in playerCanMoveCount) playerCanMoveCount[key] = {};\r\n    for (let i = 0; i < board.length; i++) {\r\n      for (let j = 0; j < board[i].length; j++) {\r\n        if (board[i][j].type === ChessTypes.NORMAL) {\r\n          const moveList = getNextPosList(board, i, j);\r\n          const player = board[i][j].player;\r\n          moveList.forEach((id) => {\r\n            playerCanMoveCount[player][id] = true;\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    const overs = {};\r\n    for (const key in playerCanMoveCount) {\r\n      if (Object.keys(playerCanMoveCount[key]) <= 0) {\r\n        gameOver = true;\r\n        if (players[parseInt(key)]) overs[key] = true;\r\n      }\r\n    }\r\n    if (gameOver)\r\n      for (const key in playerCanMoveCount) {\r\n        console.log(key, playerCanMoveCount[key], overs[key]);\r\n        if (players[parseInt(key)] && !overs[key]) winners.push(players[parseInt(key)].name);\r\n      }\r\n    console.log(\"playerCanMoveCount\", board, playerCanMoveCount, overs);\r\n  }\r\n  return {\r\n    gameOver,\r\n    winners\r\n  };\r\n}\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {connect} from 'react-redux';\r\nimport MdAccessibility from 'react-icons/lib/md/accessibility';\r\nimport MdAccessible from 'react-icons/lib/md/accessible';\r\nimport MdPets from 'react-icons/lib/md/pets';\r\nimport * as FontAwesome from 'react-icons/lib/fa'\r\nimport {ChessTypes} from '../../constants.js';\r\nimport {findChessPos} from '../../utils';\r\nimport {judgeCanBeMoveTo, getNextPosList} from \"../../utils/boardUtils\";\r\n\r\nclass ChessItem extends React.Component {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.state = {}\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n  }\r\n\r\n  render() {\r\n    const {player, type, beSelected, canBeMoveTo, onSelect, onMoveTo, canBeSelect, typeChangeInfo} = this.props;\r\n    const onClick = () => {\r\n      if (canBeMoveTo) {\r\n        onMoveTo();\r\n      } else if (type != ChessTypes.NONE && canBeSelect) {\r\n        onSelect();\r\n      }\r\n    };\r\n    let iconClassName = `chess-item ${player == 1 ? 'enemy' : ''} `;\r\n    if (type === ChessTypes.NONE) {\r\n      if (typeChangeInfo === \"LEAVE\")\r\n        iconClassName += 'leave ';\r\n      else if (typeChangeInfo === \"DIE\") {\r\n        iconClassName += 'die ';\r\n      } else {\r\n        iconClassName += 'normal-none  ';\r\n      }\r\n    } else {\r\n      if (typeChangeInfo === \"ARRIVE\") {\r\n        iconClassName += 'arrive ';\r\n      } else {\r\n        iconClassName += 'normal-display ';\r\n      }\r\n    }\r\n\r\n    let icon = null;\r\n    if (player == 0)\r\n      icon = <MdAccessibility className={iconClassName}/>\r\n    else\r\n      icon = <MdAccessibility className={iconClassName}/>;\r\n    return (\r\n      <div\r\n        className={`chess-block ${beSelected ? 'selected' : ''} ${canBeMoveTo ? 'can-be-move-to' : ''} ${canBeSelect && !beSelected ? 'can-be-select' : ''} `}\r\n        onClick={onClick}>\r\n        {icon}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n// TodoItem.propTypes = {\r\n//   onToggle: PropTypes.func.isRequired,\r\n//   onRemove: PropTypes.func.isRequired,\r\n//   completed: PropTypes.bool.isRequired,\r\n//   text: PropTypes.string.isRequired\r\n// }\r\n\r\n\r\nconst mapStateToProps = (state, {chessId, player}) => ({\r\n  beSelected: state.chessBoard.selected && state.chessBoard.selectId == chessId,\r\n  canBeMoveTo: judgeCanBeMoveTo(state.chessBoard, chessId),\r\n  canBeSelect: state.player.nowPlayer === player && state.player.local.indexOf(player) != -1,\r\n});\r\n\r\nexport default connect(mapStateToProps)(ChessItem);\r\nexport { getNextPosList };\r\n","import {doMoveAction, getNextPosList} from \"../boardUtils\";\r\nimport {ChessTypes} from \"../../constants\";\r\nimport {findChessPos} from \"../index\";\r\n\r\n/**\r\n * Returns a random integer between min (inclusive) and max (inclusive).\r\n * The value is no lower than min (or the next integer greater than min\r\n * if min isn't an integer) and no greater than max (or the next integer\r\n * lower than max if max isn't an integer).\r\n * Using Math.round() will give you a non-uniform distribution!\r\n */\r\nfunction getRandomInt(min, max) {\r\n  min = Math.ceil(min);\r\n  max = Math.floor(max);\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nconst AI = {\r\n  getTheMove: function (board, player) {\r\n    const moves = [];\r\n    for (let i = 0; i < board.length; i++) {\r\n      for (let j = 0; j < board[i].length; j++) {\r\n        if (board[i][j].type === ChessTypes.NORMAL && board[i][j].player === player) {\r\n          const moveList = getNextPosList(board, i, j);\r\n          moveList.forEach(one => {\r\n            moves.push({now: board[i][j].id, next: one}); //存现在的和next的id\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    const theMove = moves[getRandomInt(0, moves.length - 1)];\r\n    return theMove;\r\n  },\r\n  getNextBoard: (board, player) => {\r\n    //id: 16, player: 1, type: \"有棋\"\r\n    //{id: 25, player: null, type: \"无棋\"}\r\n    console.log(\"AI getNextBoard board?!\", board, player);\r\n\r\n    // const flatBoard = flatten(board);\r\n    // const canMoveChesses = flatBoard.filter(one=>one.player===player);\r\n    const theMove = AI.getTheMove(board, player);\r\n\r\n    let newBoard = board;\r\n    if (theMove) {\r\n      const now = findChessPos(board, theMove.now);\r\n      const next = findChessPos(board, theMove.next);\r\n      console.log(\"getNextBoard theMove\", theMove, now, next);\r\n      newBoard = doMoveAction(board, now, next.x, next.y);\r\n    }\r\n\r\n    return newBoard;\r\n  }\r\n};\r\n\r\nexport default AI;\r\n","// const host = 'http://localhost:3000';\n// const socketPath = '/socket';\n\nimport AI from \"../ai/ai\";\nimport {judgeGameOver} from \"../boardUtils\";\n\nexport default class AIClient {\n  funcs={\n    onMessage: ()=>{},\n    onOpen: ()=>{}\n  }\n  connect(host) {\n    const data = {};\n    // this.funcs.onOpen(data);\n  }\n\n  disconnect() {\n\n  }\n\n  send(data) {\n    // this.ws.send(JSON.stringify(data));\n    console.log(\"AIClient send\", data);\n    setTimeout(()=>{\n      const {nowPlayer, isRoundEnd} = data; // nowPlayer好像经常是null，那边没好好传过来，待修复\n\n      if(judgeGameOver(data.board).gameOver) return; //游戏已经结束的话，就不用计算了\n\n      const realNowPlayer = 1;\n      const newNowPlayer = 0;\n      const resData = {\n        board: AI.getNextBoard(data.board, 1),\n        isRoundEnd: false,\n        needMessage: false,\n        nowPlayer: newNowPlayer\n      };\n      this.funcs.onMessage({data: JSON.stringify(resData)});\n    }, 1000);\n  }\n\n  setOnMessage(func) {\n    // this.ws.onmessage = func;\n    this.funcs.onMessage = func;\n  }\n\n  setOnOpen(func) {\n    // this.ws.onopen = func;\n    this.funcs.onOpen = func;\n  }\n}\n","import React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport './style.css';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\nimport {setBoard} from '../../chessBoard/actions.js';\r\nimport {reset, updateSocket} from '../actions.js';\r\nimport SocketClient, {gameMessage} from '../../utils/controlClients/SocketClient';\r\nimport {roundEnd, setLocalPlayer} from '../../player/actions';\r\nimport {moveTo} from '../../chessBoard/actions';\r\nimport {socketContainer} from '../../utils';\r\nimport {getNextPosList} from '../../chessBoard/views/chessItem';\r\nimport {ChessTypes} from '../../constants';\r\nimport AIClient from \"../../utils/controlClients/AIClient\";\r\nimport {flatten, judgeGameOver} from \"../../utils/boardUtils\";\r\n\r\nclass PlayControl extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    console.log('PlayControl　constructor', props);\r\n    const {roomId, vsAI, player} = props;\r\n    this.props.setBoard();\r\n    if (props.roomId || vsAI) {\r\n      this.props.setLocalPlayer([parseInt(props.player)]);\r\n\r\n      const host = process.env.REACT_APP_WS_HOST + props.roomId;\r\n      const GameClient = vsAI ? AIClient : SocketClient;\r\n      const socketClient = new GameClient();\r\n      socketClient.connect(host);\r\n      socketClient.setOnOpen(() => {\r\n        socketClient.send(gameMessage(null, null, null, true));\r\n      });\r\n      socketClient.setOnMessage((event) => {\r\n        console.log(event, event.data, JSON.parse(event.data));\r\n        // alert(event.data);\r\n        const data = JSON.parse(event.data);\r\n        if (data.needMessage) {\r\n          const {board, nowPlayer, gameOver} = this.props;\r\n          if (!gameOver) socketClient.send(gameMessage(board, nowPlayer, false));\r\n        } else {\r\n          props.onReceiveBoard(data);\r\n        }\r\n      });\r\n      socketContainer.setSocketClient(socketClient);\r\n    } else {\r\n      this.props.setLocalPlayer([0, 1]);\r\n      socketContainer.setSocketClient(null);\r\n    }\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    const {gameOver: preGameOver} = this.props;\r\n    const {gameOver, winners} = nextProps;\r\n    console.log('judge gameOver! ', this.props, gameOver, preGameOver);\r\n    if (gameOver && !preGameOver) {\r\n      alert(`游戏结束！胜者是${winners}`);\r\n      // window.location.reload();\r\n      nextProps.resetAll();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      chessBoard, player, gameOver, roomId,\r\n    } = this.props;\r\n\r\n    return (\r\n      <div className=\"full-window\">\r\n        <div className=\"inner-window\">\r\n          {roomId ? <div>房间{roomId}</div> : ''}\r\n          <div>{chessBoard}</div>\r\n          <div>{player}</div>\r\n          <div>规则：本回合移动的己方棋子和其移动后相邻的棋子，两个棋子组成炮台，杀死处在该炮台连线上相邻的敌方棋子。如果这条直线上有4个棋子则杀不掉。当有玩家只剩1颗棋子或者无法行动时输掉。</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n  const board = state.chessBoard.board;\r\n\r\n  const {gameOver, winners} = judgeGameOver(board, state.player, state.player.order);\r\n  // console.log(flatBoard, gameOver);\r\n  return {\r\n    gameOver,\r\n    winners: gameOver ? winners : [],\r\n    board,\r\n    nowPlayer: state.player.nowPlayer,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  setLocalPlayer: (local) => {\r\n    dispatch(setLocalPlayer(local));\r\n  },\r\n  setNowPlayer: (nowPlayer) => {\r\n    dispatch(setLocalPlayer(null, nowPlayer));\r\n  },\r\n  setBoard: (board) => {\r\n    dispatch(setBoard(board));\r\n  },\r\n  resetAll: () => {\r\n    dispatch(setBoard());\r\n  },\r\n  onReceiveBoard: (data) => {\r\n    const {board, nowPlayer, isRoundEnd} = data;\r\n    console.log('will dispatch, board=', board, nowPlayer, isRoundEnd);\r\n    dispatch(setBoard(board));\r\n    if (nowPlayer || nowPlayer === 0) dispatch(setLocalPlayer(null, nowPlayer));\r\n    if (isRoundEnd) dispatch(roundEnd());\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PlayControl);\r\n","import React, {Component} from 'react';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\n\r\nimport \"./menuPage.scss\";\r\nimport Button from '@material-ui/core/Button';\r\n\r\nconst buttonList = [\r\n  {title: '单挑AI', url: '/local-ai/1/0'},\r\n  {title: '本地双人', url: '/local'},\r\n  // {title: '在线双人-南位', url: '/online/123/0'},\r\n  // {title: '在线双人-北位', url: '/online/123/1'},\r\n  {\r\n    title: '网络对战', urlFunc: () => {\r\n      const randomNumber = Math.floor(Math.random() * 1000000 + 1);\r\n      return `/room/${randomNumber}`\r\n    }\r\n  },\r\n];\r\n\r\nconst menuPage = (props) => (<div className=\"menu-page\">\r\n  <div className={\"title-field\"}>\r\n    <div className=\"page-title\">\r\n      熊蛙棋\r\n    </div>\r\n  </div>\r\n  <div className=\"right-field\">\r\n    <div className=\"page-select-list\">\r\n      {buttonList.map(buttonData => {\r\n        const {title, url, urlFunc} = buttonData;\r\n        return <div>\r\n          <Button\r\n            raised className=\"mdc-button my-button\" onClick={() => {\r\n            if (urlFunc) props.history.push(urlFunc());\r\n            else props.history.push(url);\r\n          }}>\r\n            {title}\r\n          </Button></div>\r\n      })}\r\n    </div>\r\n  </div>\r\n  {/* <div><Link to=\"/\">主菜单</Link></div> */}\r\n</div>);\r\n\r\nexport default menuPage;\r\n","import React, {Component} from 'react';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\n\r\nimport \"./RoomMenu.scss\";\r\nimport Button from '@material-ui/core/Button';\r\nimport {CopyToClipboard} from \"react-copy-to-clipboard\";\r\n\r\nconst buttonList = [\r\n  {title: '玩家1进入', urlFunc: (roomId, playerId) => `/online/${roomId}/${playerId}`},\r\n  {title: '玩家2进入', urlFunc: (roomId, playerId) => `/online/${roomId}/${playerId}`},\r\n];\r\n\r\nconst OnePlayerPanel = (props) => {\r\n  const {playerName, url} = props;\r\n  return <div className='one-player-panel'>\r\n    <div>{playerName}</div>\r\n    <div>\r\n      <input className='my-input' value={url} readOnly={true}/>\r\n      <CopyToClipboard text={url}\r\n                       onCopy={() => {\r\n                       }}>\r\n        <button className='copy-button' onClick={() => {\r\n        }}>复制网址\r\n        </button>\r\n      </CopyToClipboard>\r\n    </div>\r\n    <Button\r\n      raised className=\"enter-button\" onClick={() => {\r\n      props.onJump && props.onJump();\r\n    }}>{`进入${playerName}座位`}</Button>\r\n  </div>\r\n};\r\n\r\nconst RoomMenu = (props) => {\r\n  const {history, roomId} = props;\r\n  const {host, href, pathname} = window.location;\r\n  console.log(\"location!\", props.location, window.location);\r\n  const urlPrefix = href.split('#')[0];\r\n  return (<div className=\"menu-page\">\r\n    <div className={\"title-field\"}>\r\n      <div className=\"page-info\">\r\n        网络1V1对战：把一个座位的网址发给朋友，自己进入另一个座位网址。\r\n      </div>\r\n      <div><Button outlined className=\"back-button\" onClick={() => {\r\n        props.history.push(`/`);\r\n      }}>返回主菜单</Button></div>\r\n    </div>\r\n    <div className=\"right-field\">\r\n      <div className=\"player-copy-field\">\r\n        <OnePlayerPanel playerName={\"玩家1\"} url={`${urlPrefix}#/online/${roomId}/${0}`} onJump={() => {\r\n          props.history.push(`/online/${roomId}/${0}`);\r\n        }}/>\r\n        <OnePlayerPanel playerName={\"玩家2\"} url={`${urlPrefix}#/online/${roomId}/${1}`} onJump={() => {\r\n          props.history.push(`/online/${roomId}/${1}`);\r\n        }}/>\r\n      </div>\r\n    </div>\r\n  </div>);\r\n}\r\n\r\nexport default RoomMenu;\r\n","/**\r\n * Created by yuiff on 2018/4/1.\r\n */\r\nimport React, {Component} from 'react';\r\nimport {connect} from 'react-redux';\r\nimport './style.css';\r\nimport {Link, Switch, Route} from 'react-router-dom';\r\nimport PlayControl from './gamePlaying.js';\r\nimport menuPage from \"../../menu/menuPage\";\r\nimport RoomMenu from \"../../menu/RoomMenu\";\r\n\r\nclass RouteControl extends Component {\r\n  render() {\r\n    const {chessBoard, player, gameOver} = this.props;\r\n    const playControl = ({match, ...others}) => {\r\n      // console.log(\"playControl\", match, others, this.props);\r\n      return <PlayControl {...this.props} roomId={match.params.roomId}\r\n                   player={match.params.playerId} vsAI={match.params.hasAI}/>;\r\n    }\r\n    const roomControl = (props) => {\r\n      const {match} = props;\r\n      return <RoomMenu {...props} roomId={match.params.roomId}/>\r\n    };\r\n    return (\r\n      <div className=\"full-window\">\r\n        <div className=\"inner-window\">\r\n          <Switch>\r\n            <Route path=\"/local\" component={playControl}/>\r\n            <Route path=\"/local-ai/:hasAI/:playerId\" component={playControl} />\r\n            <Route path=\"/online/:roomId/:playerId\" component={playControl}/>\r\n            <Route exact path=\"/\" component={menuPage}/>\r\n            <Route path=\"/room/:roomId\" component={roomControl}/>\r\n          </Switch>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = state => ({});\r\n\r\n\r\nexport default connect(mapStateToProps)(RouteControl);\r\n","import {SELECT, MOVE_TO, SET_BOARD} from './actionTypes.js';\r\nimport {findChessPos, socketContainer} from '../utils';\r\nimport {ChessTypes} from '../constants.js';\r\nimport {createBearFrogBoard} from '../utils/';\r\nimport {gameMessage} from '../utils/controlClients/SocketClient';\r\nimport {doMoveAction} from \"../utils/boardUtils\";\r\n\r\nexport default (state = {}, action) => {\r\n  switch (action.type) {\r\n    case SELECT: {\r\n      console.log(action);\r\n      return {\r\n        ...state,\r\n        selected: true,\r\n        selectId: action.id,\r\n      };\r\n    }\r\n    case MOVE_TO: {\r\n      const now = findChessPos(state.board, state.selectId);\r\n      const {x, y} = findChessPos(state.board, action.id);\r\n      const board = state.board;\r\n      console.log(now.x, now.y, x, y, state.selectId, action.id, state.board);\r\n      const newBoard = doMoveAction(board, now, x, y);\r\n      if (socketContainer.getSocketClient()) {\r\n        socketContainer.getSocketClient()\r\n          .send(gameMessage(newBoard, null, true));\r\n      }\r\n      return {\r\n        ...state,\r\n        board: newBoard,\r\n        selected: false,\r\n      };\r\n    }\r\n    case SELECT: {\r\n      return state.filter(todoItem => todoItem.id !== action.id);\r\n    }\r\n    case SET_BOARD: {\r\n      console.log('SET_BOARD!REDUCER, got action:', action);\r\n      const board = action.board ? action.board : createBearFrogBoard();\r\n      return {\r\n        ...state,\r\n        board,\r\n      };\r\n    }\r\n    default: {\r\n      return state;\r\n    }\r\n  }\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { select, moveTo } from '../actions.js';\r\nimport { roundEnd } from '../../player/actions';\r\nimport ChessItem from './chessItem.js';\r\n\r\nimport './style.css';\r\n\r\nconst ChessBoard = ({ board, onSelect, onMoveTo }) => {\r\n  let rowKey = 0;\r\n  return (\r\n    <div className=\"chess-board\">\r\n      {\r\n                board.map(row => (\r\n                  <div className=\"row\" key={rowKey++}>\r\n                    {row.map((item, index) => (\r\n                      <ChessItem\r\n                        key={index}\r\n                        chessId={item.id}\r\n                        player={item.player}\r\n                        type={item.type}\r\n                        onSelect={() => onSelect(item.id)}\r\n                        onMoveTo={() => onMoveTo(item.id)}\r\n                      />\r\n                        ))}\r\n                  </div>\r\n                ))\r\n            }\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  board: state.chessBoard.board,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onSelect: (id) => {\r\n    dispatch(select(id));\r\n  },\r\n  onMoveTo: (id) => {\r\n    dispatch(moveTo(id));\r\n    dispatch(roundEnd());\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChessBoard);\r\n\r\n","import { SET_LOCAL_PLAYER, ROUND_END } from './actionTypes.js';\r\n\r\n\r\nexport default (state = {}, action) => {\r\n  switch (action.type) {\r\n    case ROUND_END: {\r\n      const newState = {\r\n        ...state,\r\n        nowPlayer: state.order[(state.order.indexOf(state.nowPlayer) + 1) % state.order.length],\r\n      };\r\n      return newState;\r\n    }\r\n    case SET_LOCAL_PLAYER: {\r\n      const nextState = {\r\n        ...state,\r\n        nowPlayer: action.nowPlayer ? action.nowPlayer : 0,\r\n      };\r\n      if (action.local) { nextState.local = action.local; }\r\n      return nextState;\r\n    }\r\n    default: {\r\n      return state;\r\n    }\r\n  }\r\n};\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport { setLocalPlayer } from '../actions.js';\r\nimport CardItem from './cardItem.js';\r\n\r\nclass PlayerZone extends Component {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.render = this.render.bind(this);\r\n    this.state = {};\r\n  }\r\n\r\n  componentDidUpdate(preProps) {\r\n    const isNowPlayer = this.props.isNowPlayer;\r\n    const onRemoveCard = this.props.onRemoveCard;\r\n    const isComputer = this.props.isComputer;\r\n    const player = this.props.player;\r\n    const cards = this.props.cards;\r\n    const nowPlayer = this.props.nowPlayer;\r\n    const life = this.props.life;\r\n    console.log('AI', isNowPlayer, isComputer, player, nowPlayer);\r\n    if (isNowPlayer && isComputer && life > 0) {\r\n      const length = cards.length;\r\n      const selectCardIndex = Math.floor(Math.random() * length);\r\n      const selectCardId = cards[selectCardIndex].id;\r\n      onRemoveCard(selectCardId, player);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    // const cards = this.props.cards;\r\n    const player = this.props.player;\r\n    const life = this.props.life;\r\n    const onRemoveCard = this.props.onRemoveCard;\r\n    const noCard = this.props.noCard;\r\n    const isComputer = this.props.isComputer;\r\n    if (noCard && !isComputer) {\r\n      let str = `出完了！你还剩${life}星星，`;\r\n      if (life === 3) str += '能够全身而退，无敌。';\r\n      else if (life < 3) str += '不足3颗，完蛋了。';\r\n      else str += '赚到。';\r\n      alert(str);\r\n      if (life >= 3) window.location.href = 'http://www.yuiffy.com/hebi.html';\r\n      else window.location.href = 'http://www.yuiffy.com/mario.html';\r\n    }\r\n    return (\r\n      <div className=\"playerZone\">\r\n        {\r\n                    life <= 0 ?\r\n                      <div className=\"dead\">\r\n                            死了。\r\n                      </div>\r\n                        :\r\n                        // life!==0\r\n                      <div>\r\n                        {player}\r\n                        {/* <div className=\"cardZone\"> */}\r\n                        {/* { */}\r\n                        {/* cards.map((item) => ( */}\r\n                        {/* <CardItem */}\r\n                        {/* key={item.id} */}\r\n                        {/* type={item.type} */}\r\n                        {/* player={player} */}\r\n                        {/* onRemove={() => onRemoveCard(item.id, player)} */}\r\n                        {/* /> */}\r\n                        {/* )) */}\r\n                        {/* } */}\r\n                        {/* </div> */}\r\n                        <div className=\"lifeZone\">\r\n                          {\r\n                                    Array.from(Array(life), () => '★').map(item => (\r\n                                      <span>{item}</span>\r\n                                    ))\r\n                                }\r\n                        </div>\r\n                      </div>\r\n                }\r\n\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nPlayerZone.propTypes = {\r\n  cards: PropTypes.array.isRequired,\r\n  life: PropTypes.number.isRequired,\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n  cards: state.player.players[ownProps.player].cards,\r\n  life: state.player.players[ownProps.player].life,\r\n  noCard: false,\r\n  isComputer: state.player.players[ownProps.player].isComputer,\r\n  isNowPlayer: state.player.nowPlayer === ownProps.player,\r\n  nowPlayer: state.player.nowPlayer,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onRemoveCard: (id, player) => {\r\n    dispatch(setLocalPlayer(id, player));\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PlayerZone);\r\n\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\nimport { playCard } from '../actions.js';\r\n\r\nconst CardItem = ({\r\n  type, active, isShow, onRemove,\r\n}) => {\r\n  let typeShow = '';\r\n  switch (type) {\r\n    case 0:\r\n      typeShow = '石头';\r\n      break;\r\n    case 1:\r\n      typeShow = '剪刀';\r\n      break;\r\n    case 2:\r\n      typeShow = '布';\r\n      break;\r\n  }\r\n  return (\r\n    <div\r\n      className=\"card\"\r\n      onClick={active ? onRemove : null}\r\n      style={{\r\n                 backgroundColor: active ? 'yellow' : 'white',\r\n             }}\r\n    >\r\n      {active || isShow ? typeShow : ''}\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\nCardItem.propTypes = {\r\n  type: PropTypes.string.isRequired,\r\n  active: PropTypes.bool.isRequired,\r\n  isShow: PropTypes.bool,\r\n  onClick: PropTypes.func.isRequired,\r\n};\r\n\r\nconst mapStateToProps = (state, ownProps) => ({\r\n  active: state.game.nowPlayer === ownProps.player && state.game.players[ownProps.player].cardPlayed.length === 0,\r\n});\r\n\r\n\r\nexport default connect(mapStateToProps)(CardItem);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\n// import {bindActionCreators} from 'redux';\r\nimport CardItem from './cardItem.js';\r\nimport { playCard, showHand, roundEnd } from '../actions.js';\r\n// import {FilterTypes} from '../../constants.js';\r\n\r\nconst PublicZone = ({ nowPlayerName, roundEnd }) => (\r\n  <div className=\"\" onClick={roundEnd}>\r\n            现在轮到{nowPlayerName}行动\r\n  </div>\r\n);\r\n\r\nconst mapStateToProps = state => ({\r\n  nowPlayerName: state.player.players[state.player.nowPlayer].name,\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  roundEnd: () => {\r\n    dispatch(roundEnd());\r\n  },\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PublicZone);\r\n\r\n","import React from 'react';\r\nimport PlayerZone from './playerZone.js';\r\nimport PublicZone from './publicZone.js';\r\n\r\nimport './style.css';\r\n\r\nexport default () => (\r\n  <div className=\"\">\r\n    <PublicZone />\r\n  </div>\r\n);\r\n\r\n","import React from 'react';\r\nimport { view as GameControl } from './gameControl/';\r\nimport { view as ChessBoard } from './chessBoard/';\r\nimport { view as Player } from './player/';\r\nimport { Link, Route, Switch } from 'react-router-dom';\r\n\r\nfunction App() {\r\n  const chessBoard = <ChessBoard />;\r\n  const player = <Player />;\r\n  return (\r\n    <GameControl chessBoard={chessBoard} player={player} />\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { createStore, combineReducers, applyMiddleware, compose } from 'redux';\r\n\r\nimport { reducer as playerReducer } from './player';\r\nimport { reducer as chessBoardReducer } from './chessBoard';\r\nimport { reducer as gameControlReducer } from './gameControl';\r\nimport { getInitState } from './utils/';\r\n\r\nconst win = window;\r\n\r\nconst reducer = combineReducers({\r\n  player: playerReducer,\r\n  chessBoard: chessBoardReducer,\r\n  gameControl: gameControlReducer,\r\n});\r\n\r\n\r\nconst middlewares = [];\r\nif (process.env.NODE_ENV !== 'production') {\r\n  middlewares.push(require('redux-immutable-state-invariant').default());\r\n}\r\n\r\nconst storeEnhancers = compose(\r\n  applyMiddleware(...middlewares),\r\n  (win && win.devToolsExtension) ? win.devToolsExtension() : f => f,\r\n);\r\n\r\nexport default createStore(reducer, getInitState(), storeEnhancers);\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport App from './App';\r\nimport { HashRouter as BrowserRouter } from 'react-router-dom';\r\n\r\nimport store from './Store.js';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <BrowserRouter>\r\n      <App />\r\n    </BrowserRouter>\r\n  </Provider>,\r\n  document.getElementById('root'),\r\n);\r\n"],"sourceRoot":""}